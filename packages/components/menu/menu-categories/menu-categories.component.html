@let isMobileScreen = isMobileView$ | async;

<ng-container *ngIf="categories$ | async as categories">
  <ng-container *ngIf="categories?.length">
    <ng-container *ngIf="isCategoriesHidden$ | async">
      <div *ngIf="!isMobileScreen" class="menu-categories-spacer"></div>

      <div [class]="menuCategoriesClassesEnum.MENU_CATEGORIES">
        <div *ngIf="isMobileScreen && $isMenuToggle()"
             [class]="menuCategoriesClassesEnum.MENU_CATEGORIES + '__toggle-button'">
          <button mat-icon-button (click)="toggleSidenav(isMobileScreen)">
            <mat-icon>menu_open</mat-icon>
          </button>
        </div>
        <a *ngIf="!isMobileScreen && brandLogo$ | async as brandLogo" class="menu-categories__logo"
           [routerLink]="brandLogo?.navigationSlug || '/dashboard'">
          @let brandLogoUrl = brandLogo?.url;
          @let brandLogoSize = brandLogo?.size || DEFAULT_LOGO_SIZE;

          <img *ngIf="brandLogoUrl"
               [src]="brandLogoUrl"
               [width]="brandLogoSize"
               [height]="brandLogoSize"
               alt="brand-logo">
        </a>
        <div [class]="menuCategoriesClassesEnum.MENU_CATEGORIES_CONTAINER">
          @let selectedCategoryNameEn = selectedCategory?.name?.en?.toLowerCase();
          @let hoveredCategoryNameEn = hoveredCategory?.name?.en?.toLowerCase();

          <div
            #menuCategory
            *ngFor="let category of categories"
            [class]="menuCategoriesClassesEnum.MENU_CATEGORY"
            [ngClass]="{
              'menu-link': isMobileScreen,
              'active': selectedCategoryNameEn === category?.name?.en?.toLowerCase(),
              'active-with-stretch': selectedCategoryNameEn === category?.name?.en?.toLowerCase() && isMobileScreen
            }"
            (click)="onNavigate(category)"
            [attr.data-qa]="category.dataQa || 'default-' + category.icon + 'category'"
          >
            @let categoryNameEn = category?.name?.en?.toLowerCase();
            @let categoryIcon = category?.icon;
            @let categoryName = category?.name;
            @let isCategoryWithoutSubcategories = category?.isLinkWithoutSubcategories;

            @if (categoryIcon) {
              <div class="menu-category__icon menu-link rounded-menu-link"
                   [ngClass]="{
                      'hover-active': hoveredCategoryNameEn === categoryNameEn,
                      'active-with-stretch': selectedCategoryNameEn === categoryNameEn && !isMobileScreen
                   }">
                <mat-icon>{{ categoryIcon }}</mat-icon>
              </div>
            }
            @if (categoryName) {
              <span class="menu-category__name">{{ categoryName | translate }}</span>
            }

            @if (isMobileScreen && !isCategoryWithoutSubcategories) {
              <mat-icon class="menu-category__nav-icon">chevron_right</mat-icon>
            }
          </div>
          @if ($helpCenterConfig() && isMobileScreen) {
            <ng-container
              xmDynamicPresentation
              [selector]="$helpCenterConfig()?.selector"
              [config]="$helpCenterConfig()"
            ></ng-container>
          }
        </div>
        <div class="menu-categories__actions">
          @if ($themeButtonConfig() && !isMobileScreen) {
            <switch-theme-widget [config]="$themeButtonConfig()"></switch-theme-widget>
          }
          <button mat-mini-fab
                  [disabled]="selectedCategory?.isLinkWithoutSubcategories"
                  (click)="toggleSidenav()">
            <div class="d-flex">
              <mat-icon class="action-icon action-icon__left" [ngClass]="{'rotate-chevron-left': isSidenavPinned}">
                chevron_left
              </mat-icon>
              <mat-icon class="action-icon action-icon__right" [ngClass]="{'rotate-chevron-right': isSidenavPinned}">
                chevron_right
              </mat-icon>
            </div>
          </button>
        </div>
      </div>
    </ng-container>
  </ng-container>
</ng-container>
